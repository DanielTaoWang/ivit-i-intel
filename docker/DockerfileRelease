# ivit-i-intel
FROM openvino/ubuntu18_dev_no_samples
USER root

ARG VER
ARG GITHUB_USER
ARG GITHUB_TOKEN

ENV IVIT=ivit-i-intel
ENV WS=/workspace
ENV GITHUB_REPOSITORY=InnoIPA/ivit-i-intel
# ENV DEBIAN_FRONTEND noninteractive  

# Download Repository
RUN echo -e "\n - Install Git package ... \n" \
&& apt-get update \
&& apt-get install -qy git ssh openssh-server jq boxes \
&& echo -e "\n - Downlaod Githun Repository ... \n" \
&& git config --system credential.helper store \
&& echo "https://${GITHUB_USER}:${GITHUB_TOKEN}@github.com" > ~/.git-credentials \
&& git clone --recurse-submodules https://github.com/InnoIPA/ivit-i-intel.git --branch ${VER} \
&& mv -f ${IVIT} ${WS}

# Install Relatived Package
WORKDIR /workspace

RUN /workspace/docker/requirements.sh \
&& /workspace/docker/gen_inno_verify.sh \
&& mv /workspace/docker/inno_verify /workspace/docker/entrypoint /usr/bin \
&& echo -e "\n - Cythonize iVIT-I ... \n" \
&& chmod u+x /workspace/cythonize.sh \
&& /workspace/cythonize.sh \
&& echo -e "\n - Remove Relatived Script  ... \n"

# Define Entrypoint
ENTRYPOINT [ "entrypoint" ]

# docker run -it --privileged -v /dev:/dev --name ivit-i-intel  --device /dev/dri --device-cgroup-rule='c 189:* rmw'  --net=host --ipc=host -v /etc/localtime:/etc/localtime:ro -v /tmp/.x11-unix:/tmp/.x11-unix:rw -e DISPLAY=unix:0 maxchanginnodisk/ivit-i-intel:v0.8 /workspace/init_samples.sh bash